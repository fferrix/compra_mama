import streamlit as st
import random

# TÃ­tulo y subtÃ­tulo de la aplicaciÃ³n
st.title("Lista de Compras de Covas")
st.subheader("Â¿QuÃ© necesitas comprar para casa?")

# InicializaciÃ³n de la lista de compras
if 'compra_casa' not in st.session_state:
    st.session_state.compra_casa = []

# Campo de entrada para aÃ±adir elementos a la lista
nuevo_item = st.text_input("AÃ±ade un nuevo Ã­tem y pulsa Enter:", key="nuevo_item_input")

# FunciÃ³n para mostrar mensaje gracioso en gallego
def mostrar_mensaje_gracioso(item):
    mensajes_graciosos = [
        f'Â¡Ai! Que {item} se foi! Â¡Andres vai devorar eso todo! ğŸ´',
        f'Â¡Ai! Que {item} se foi! Â¡Que mon! Vai engullir iso ğŸ™Š',
        f'Â¡Ai! Que {item} se foi! Â¡Vas acabar co diÃ±eiro! ğŸ’¸',
        f'Â¡Ai! Que {item} se foi! Sigue gastando os cartiÃ±os ho ğŸ’£'
    ]
    mensaje = random.choice(mensajes_graciosos)
    st.warning(mensaje)

# Evento cuando se presiona Enter en el campo de entrada
if st.session_state.nuevo_item_input and st.session_state.nuevo_item_input != nuevo_item:
    st.session_state.nuevo_item_input = nuevo_item
    if nuevo_item.strip() != "":
        st.session_state.compra_casa.append({"item": nuevo_item, "eliminado": False})
        st.success(f'"{nuevo_item}" ha sido aÃ±adido a la lista.')

# BotÃ³n para agregar un nuevo Ã­tem a la lista
if st.button("Mais comida pao carro"):
    if nuevo_item.strip() != "":
        st.session_state.compra_casa.append({"item": nuevo_item, "eliminado": False})
        st.success(f'"{nuevo_item}" ha sido aÃ±adido a la lista.')

# Mostrar la lista de compras actual y opciÃ³n para eliminar
if st.session_state.compra_casa:
    st.subheader("Lista de Compras:")
    for idx, item_info in enumerate(st.session_state.compra_casa):
        checkbox_key = f"eliminar_{idx}"
        eliminado = st.checkbox(item_info["item"], key=checkbox_key)
        if eliminado:
            # Mostrar mensaje gracioso en gallego automÃ¡ticamente
            mostrar_mensaje_gracioso(item_info["item"])
            # Eliminar el Ã­tem de la lista
            st.session_state.compra_casa.remove(item_info)

# Footer o secciÃ³n adicional
st.write("---")
st.write("Â¡Que te divirtas comprando! ğŸ›’")
